!function(root){"use strict";var d={initialize:_.noop,base:"http://localhost:8000/json",url:"",dirty:!1},Model=function(properties){return this.construct(properties)};Model.lastId=0,Model.extend=extend,Model.prototype={construct:function(props){_.defaults(this,d),this.properties=_.extend(this.defaults||{},_.omit(props,"url","initialize","constructor")),_.has(this.properties,"id")?this.constructor.lastId=this.get("id")+1:this.set("id",this.constructor.lastId++),this.fullURL=this.base.replace(/\/$/,"")+"/"+this.url.replace(/^\/|\/$/g,""),this.initialize.call(this,props)},get:function(a){return this.properties[a]},set:function(a,b){this.dirty=!0,this.properties[a]=b},has:function(a){return _.has(this.properties,a)},fetch:function(){var _super=this,destination=this.fullURL+"/"+(this.has("id")?this.get("id"):""),lsData=LS.get(destination);return this.properties=lsData,{localStorage:lsData,promise:$.ajax({url:destination,type:"get"}).then(function(data){_super.properties=data},function(xhr,status,err){console.error("Error fetching model ",err)})}},save:function(){var _super=this,destination=this.fullURL+"/"+(this.has("id")?this.get("id"):"");return LS.set(destination,this.properties),$.ajax({url:destination,type:"post",data:this.properties}).done(function(){_super.dirty=!1})},"super":function(){return this.constructor.__super__||this.constructor},toJSON:function(){return this.properties}},root.Model=Model}(this),function(root){"use strict";var d={initialize:_.noop,base:"http://localhost:8000/view",url:"",container:"",model:null,collection:null,dirty:!1},View=function(properties){return this.construct(properties)};View.lastId=0,View.extend=extend,View.prototype={construct:function(props){_.defaults(this,d),this.html="",_.extend(this,_.omit(props,"initialize","constructor")),_.has(this,"id")?this.constructor.lastId=this.id+1:this.id=this.constructor.lastId++,this.$el=$(this.container),this.$=function(s){return this.$el.find(s)},this.fullURL=this.base.replace(/\/$/,"")+"/"+this.url.replace(/^\/|\/$/g,""),this.initialize.call(this,props)},fetch:function(){var _super=this,destination=this.fullURL+"/"+(_.has(this,"id")?this.id:""),lsData=LS.get(destination);return this.html=lsData,{localStorage:lsData,promise:$.ajax({url:destination,type:"get"}).then(function(data){_super.html=data},function(xhr,status,err){console.error("Error fetching model ",err)})}},render:function(){this.$el.html(this.html)},save:function(){var destination=this.fullURL+"/"+(_.has(this,"id")?this.id:"");LS.set(destination,this.html)},"super":function(){return this.constructor.__super__||this.constructor}},root.View=View}(this),function(root){"use strict";var d={initialize:_.noop};root.test=[];var Collection=function(models){return _.isArray(models)||(models=[models]),this.construct(models)};Collection.extend=extend,Collection.prototype={construct:function(models){_.defaults(this,d),this.models=models,this.initialize.call(this,models)},at:function(i){return this.models[i]},get:function(obj){_.isNumber(obj)&&(obj={id:obj});var match=_.matches(obj);return _.find(this.models,function(model){return match(model.properties)})},has:function(a){if(a instanceof Model)return _.contains(this.models,a);for(var eq=function(b){return _.isEqual(a,b)},result=!1,i=0,len=this.models.length;len>i;i++)if(eq(this.models[i].properties)){result=!0;break}return result},fetch:function(){return $.when.apply($,_.map(this.models,function(m){var f=m.fetch();return this.models=f.localStorage||[],f.promise}))},save:function(){return $.when.apply($,_.map(this.models,function(m){return m.save()}))},toJSON:function(){return this.properties},"super":function(){return this.__super__||this.constructor.__super__}},root.Collection=Collection}(this);
//# sourceMappingURL=mv.js.map